local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- ‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
local NORMAL_SPEED = 16
local NORMAL_JUMP = 50

-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô (‡∏¢‡∏¥‡πà‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏¢‡∏¥‡πà‡∏á‡∏•‡∏∑‡πà‡∏ô)
local ROTATE_SMOOTH = 0.18

-- ‡∏•‡∏ö‡πÅ‡∏£‡∏á‡∏ù‡∏±‡πà‡∏á client ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏Å‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
local function clearClientLocks(root)
	for _,v in ipairs(root:GetChildren()) do
		if v:IsA("BodyMover")
		or v:IsA("LinearVelocity")
		or v:IsA("AngularVelocity")
		or v:IsA("VectorForce")
		or v:IsA("BodyGyro")
		or v:IsA("BodyVelocity") then
			v:Destroy()
		end
	end
end

local function stabilize(char)
	local hum = char:WaitForChild("Humanoid")
	local root = char:WaitForChild("HumanoidRootPart")

	-- ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô/‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏∑‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
	hum.AutoRotate = true

	RunService.Heartbeat:Connect(function(dt)
		if hum.Health <= 0 then return end

		-- ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô/‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î
		if hum.WalkSpeed < NORMAL_SPEED then hum.WalkSpeed = NORMAL_SPEED end
		if hum.JumpPower < NORMAL_JUMP then hum.JumpPower = NORMAL_JUMP end

		-- ‡∏Å‡∏±‡∏ô‡πÅ‡∏ä‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á client
		hum.PlatformStand = false

		-- ‡∏Å‡∏±‡∏ô Anchor
		if root.Anchored then root.Anchored = false end
		for _,p in ipairs(char:GetDescendants()) do
			if p:IsA("BasePart") and p.Anchored then
				p.Anchored = false
			end
		end

		-- ‡∏•‡∏ö‡πÅ‡∏£‡∏á‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ
		clearClientLocks(root)

		-- üîπ ‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÅ‡∏Ç‡πá‡∏á
		local moveDir = hum.MoveDirection
		if moveDir.Magnitude > 0.01 then
			local desired = CFrame.new(
				root.Position,
				root.Position + Vector3.new(moveDir.X, 0, moveDir.Z)
			)

			-- ‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô ‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å
			root.CFrame = root.CFrame:Lerp(desired, ROTATE_SMOOTH)
		end
	end)
end

if player.Character then
	stabilize(player.Character)
end

player.CharacterAdded:Connect(function(char)
	task.wait(0.15)
	stabilize(char)
end)

